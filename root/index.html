<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>å‡ºè¡Œè®¡åˆ’</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-[#f7f7f8]">
  <div id="root" class="min-h-screen p-4"></div>
  <script type="text/babel">
    const { useState } = React;

    const typeOptions = ['å‡ºå‘åœ°', 'å‡ºè¡Œ', 'é…’åº—', 'é¤å…', 'æ´»åŠ¨åœ°ç‚¹'];
    const travelModes = ['é«˜é“/åŠ¨è½¦', 'é£æœº', 'åœ°é“/å…¬äº¤', 'è‡ªé©¾/å‡ºç§Ÿè½¦'];

    const travelFieldMap = {
      'é«˜é“/åŠ¨è½¦': [
        { name: 'trainNumber', label: 'è½¦æ¬¡å·' },
        { name: 'departureStation', label: 'å‡ºå‘ç«™' },
        { name: 'entrance', label: 'è¿›ç«™å£' },
        { name: 'platform', label: 'ç«™å°å·' },
        { name: 'arrivalStation', label: 'åˆ°è¾¾ç«™' },
        { name: 'exit', label: 'å‡ºç«™å£' }
      ],
      'é£æœº': [
        { name: 'flightNumber', label: 'èˆªç­å·' },
        { name: 'departureAirport', label: 'å‡ºå‘æœºåœºåŠèˆªç«™æ¥¼' },
        { name: 'gate', label: 'ç™»æœºå£' },
        { name: 'arrivalAirport', label: 'åˆ°è¾¾æœºåœºåŠèˆªç«™æ¥¼' },
        { name: 'arrivalExit', label: 'å‡ºç«™å£' }
      ],
      'åœ°é“/å…¬äº¤': [
        { name: 'lineNumber', label: 'çº¿è·¯å·' },
        { name: 'boardStation', label: 'ä¸Šè½¦ç«™ç‚¹' },
        { name: 'dropStation', label: 'ä¸‹è½¦ç«™ç‚¹' },
        { name: 'exitNumber', label: 'å‡ºå£ç¼–å·' }
      ],
      'è‡ªé©¾/å‡ºç§Ÿè½¦': [
        { name: 'origin', label: 'å‡ºå‘åœ°' },
        { name: 'destination', label: 'ç›®çš„åœ°' },
        { name: 'driveDuration', label: 'é¢„è®¡è½¦ç¨‹' }
      ]
    };

    const hotelFields = [
      { name: 'checkIn', label: 'å…¥ä½æ—¶é—´', type: 'datetime-local' },
      { name: 'checkOut', label: 'é€€æˆ¿æ—¶é—´', type: 'datetime-local' },
      { name: 'room', label: 'æˆ¿å‹/å¤‡æ³¨' }
    ];

    const restaurantFields = [
      { name: 'cost', label: 'äººå‡æ¶ˆè´¹' },
      { name: 'note', label: 'ç‰¹è‰²/å¤‡æ³¨' }
    ];

    const activityFields = [
      { name: 'period', label: 'æ´»åŠ¨æ—¶é—´æ®µ' },
      { name: 'organizer', label: 'ä¸»åŠæ–¹/å¤‡æ³¨' }
    ];

    const linkIcons = {
      gaode: 'https://www.amap.com/favicon.ico',
      xhs: 'https://www.xiaohongshu.com/favicon.ico',
      meituan: 'https://www.meituan.com/favicon.ico'
    };

    function TravelForm({ onAdd }) {
      const initialState = {
        type: 'å‡ºå‘åœ°',
        name: '',
        duration: '',
        links: { gaode: '', xhs: '', meituan: '' },
        travelMode: '',
        fields: {}
      };
      const [form, setForm] = useState(initialState);

      const handleChange = (field, value) => {
        setForm(prev => ({ ...prev, [field]: value }));
      };

      const handleLinkChange = (key, value) => {
        setForm(prev => ({ ...prev, links: { ...prev.links, [key]: value } }));
      };

      const handleFieldChange = (key, value) => {
        setForm(prev => ({ ...prev, fields: { ...prev.fields, [key]: value } }));
      };

      const handleTypeChange = e => {
        const newType = e.target.value;
        setForm({ ...initialState, type: newType });
      };

      const handleTravelModeChange = e => {
        const mode = e.target.value;
        setForm(prev => ({ ...prev, travelMode: mode, fields: {} }));
      };

      const handleSubmit = e => {
        e.preventDefault();
        const details = [];
        if (form.type === 'å‡ºè¡Œ' && form.travelMode) {
          travelFieldMap[form.travelMode].forEach(f => {
            if (form.fields[f.name]) details.push({ label: f.label, value: form.fields[f.name] });
          });
        } else {
          const map = {
            'é…’åº—': hotelFields,
            'é¤å…': restaurantFields,
            'æ´»åŠ¨åœ°ç‚¹': activityFields
          }[form.type];
          if (map) {
            map.forEach(f => {
              if (form.fields[f.name]) details.push({ label: f.label, value: form.fields[f.name] });
            });
          }
        }
        const card = {
          id: Date.now(),
          type: form.type,
          name: form.name,
          duration: form.duration,
          travelMode: form.type === 'å‡ºè¡Œ' ? form.travelMode : undefined,
          details,
          links: form.links
        };
        onAdd(card);
        setForm(initialState);
      };

      const renderDynamicFields = () => {
        if (form.type === 'å‡ºè¡Œ') {
          return (
            <>
              <div className="mt-4">
                <label className="block mb-1 font-medium">å‡ºè¡Œæ–¹å¼</label>
                <div className="flex flex-wrap gap-4">
                  {travelModes.map(m => (
                    <label key={m} className="flex items-center gap-2">
                      <input
                        type="radio"
                        name="travelMode"
                        value={m}
                        checked={form.travelMode === m}
                        onChange={handleTravelModeChange}
                        className="h-4 w-4 text-[#10a37f] focus:ring-[#10a37f]"
                      />
                      <span>{m}</span>
                    </label>
                  ))}
                </div>
              </div>
              {form.travelMode && travelFieldMap[form.travelMode].map(f => (
                <div key={f.name} className="mt-2">
                  <label className="block text-sm font-medium mb-1">{f.label}</label>
                  <input
                    type={f.type || 'text'}
                    className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#10a37f]"
                    value={form.fields[f.name] || ''}
                    onChange={e => handleFieldChange(f.name, e.target.value)}
                  />
                </div>
              ))}
            </>
          );
        }
        if (form.type === 'é…’åº—') {
          return hotelFields.map(f => (
            <div key={f.name} className="mt-2">
              <label className="block text-sm font-medium mb-1">{f.label}</label>
              <input
                type={f.type || 'text'}
                className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#10a37f]"
                value={form.fields[f.name] || ''}
                onChange={e => handleFieldChange(f.name, e.target.value)}
              />
            </div>
          ));
        }
        if (form.type === 'é¤å…') {
          return restaurantFields.map(f => (
            <div key={f.name} className="mt-2">
              <label className="block text-sm font-medium mb-1">{f.label}</label>
              <input
                type={f.type || 'text'}
                className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#10a37f]"
                value={form.fields[f.name] || ''}
                onChange={e => handleFieldChange(f.name, e.target.value)}
              />
            </div>
          ));
        }
        if (form.type === 'æ´»åŠ¨åœ°ç‚¹') {
          return activityFields.map(f => (
            <div key={f.name} className="mt-2">
              <label className="block text-sm font-medium mb-1">{f.label}</label>
              <input
                type={f.type || 'text'}
                className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#10a37f]"
                value={form.fields[f.name] || ''}
                onChange={e => handleFieldChange(f.name, e.target.value)}
              />
            </div>
          ));
        }
        return null;
      };

      return (
        <form onSubmit={handleSubmit} className="bg-white rounded border border-gray-200 shadow-sm p-4">
          <div>
            <label className="block text-sm font-medium mb-1">äº‹é¡¹ç±»å‹</label>
            <select
              value={form.type}
              onChange={handleTypeChange}
              className="w-full border border-gray-300 rounded px-3 py-2 bg-white focus:outline-none focus:ring-2 focus:ring-[#10a37f]"
            >
              {typeOptions.map(t => (
                <option key={t} value={t}>{t}</option>
              ))}
            </select>
          </div>
          <div className="mt-4">
            <label className="block text-sm font-medium mb-1">äº‹é¡¹åç§°</label>
            <input
              type="text"
              className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#10a37f]"
              value={form.name}
              onChange={e => handleChange('name', e.target.value)}
              required
            />
          </div>
          <div className="mt-4">
            <label className="block text-sm font-medium mb-1">é¢„è®¡æ‰€éœ€æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰</label>
            <input
              type="number"
              className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#10a37f]"
              value={form.duration}
              onChange={e => handleChange('duration', e.target.value)}
            />
          </div>
          <div className="mt-4">
            <label className="block text-sm font-medium mb-1">å¤–é“¾</label>
            <div className="flex flex-col gap-2">
              <div className="flex items-center gap-2">
                <img src={linkIcons.gaode} alt="gaode" className="w-5 h-5" />
                <input type="url" placeholder="é«˜å¾·" className="flex-1 border rounded px-2 py-1" value={form.links.gaode} onChange={e => handleLinkChange('gaode', e.target.value)} />
              </div>
              <div className="flex items-center gap-2">
                <img src={linkIcons.xhs} alt="xhs" className="w-5 h-5" />
                <input type="url" placeholder="å°çº¢ä¹¦" className="flex-1 border rounded px-2 py-1" value={form.links.xhs} onChange={e => handleLinkChange('xhs', e.target.value)} />
              </div>
              <div className="flex items-center gap-2">
                <img src={linkIcons.meituan} alt="meituan" className="w-5 h-5" />
                <input type="url" placeholder="ç¾å›¢" className="flex-1 border rounded px-2 py-1" value={form.links.meituan} onChange={e => handleLinkChange('meituan', e.target.value)} />
              </div>
            </div>
          </div>
          {renderDynamicFields()}
          <button type="submit" className="mt-4 px-4 py-2 bg-[#10a37f] hover:bg-[#0e8c68] text-white rounded">ç”Ÿæˆå¡ç‰‡</button>
        </form>
      );
    }

    function Card({ data, onDelete }) {
      const [open, setOpen] = useState(false);
      const typeIcons = {
        'å‡ºå‘åœ°': 'ğŸ“',
        'å‡ºè¡Œ': 'ğŸš—',
        'é…’åº—': 'ğŸ¨',
        'é¤å…': 'ğŸ½ï¸',
        'æ´»åŠ¨åœ°ç‚¹': 'ğŸ‰'
      };
      return (
        <div className="bg-white rounded border border-gray-200 shadow-sm">
          <div className="flex justify-between items-center p-4 cursor-pointer" onClick={() => setOpen(!open)}>
            <div className="flex items-center gap-2">
              <span>{typeIcons[data.type]}</span>
              <h3 className="font-semibold">{data.name}</h3>
            </div>
            <div className="flex items-center gap-2">
              {data.duration && <span className="text-sm text-gray-500">{data.duration} åˆ†é’Ÿ</span>}
              <button className="text-red-500" onClick={e => { e.stopPropagation(); onDelete(data.id); }}>åˆ é™¤</button>
            </div>
          </div>
          {open && (
            <div className="border-t p-4 space-y-2">
              {data.travelMode && <div>å‡ºè¡Œæ–¹å¼ï¼š{data.travelMode}</div>}
              {data.details.map((d, i) => (
                <div key={i}>{d.label}ï¼š{d.value}</div>
              ))}
              <div className="flex gap-2 pt-2">
                {Object.entries(data.links).map(([key, url]) => (
                  url ? (
                    <a key={key} href={url} target="_blank" rel="noopener noreferrer">
                      <img src={linkIcons[key]} alt={key} className="w-6 h-6" />
                    </a>
                  ) : null
                ))}
              </div>
            </div>
          )}
        </div>
      );
    }

    function Timeline({ items, onDelete }) {
      return (
        <div className="mt-6 space-y-4">
          {items.map(item => (
            <Card key={item.id} data={item} onDelete={onDelete} />
          ))}
        </div>
      );
    }

    function App() {
      const [cards, setCards] = useState([]);

      const addCard = card => setCards(prev => [...prev, card]);
      const deleteCard = id => setCards(prev => prev.filter(c => c.id !== id));

      return (
        <div className="max-w-2xl mx-auto">
          <h1 className="text-3xl font-bold text-center mb-6 text-[#10a37f]">å‡ºè¡Œè®¡åˆ’</h1>
          <TravelForm onAdd={addCard} />
          <Timeline items={cards} onDelete={deleteCard} />
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
